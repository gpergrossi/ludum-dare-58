[gd_scene load_steps=19 format=3 uid="uid://cahfo4lc3ufi6"]

[ext_resource type="PackedScene" uid="uid://7bk2wqvaqlga" path="res://scenes/furniture/couch.tscn" id="1_0wfyh"]
[ext_resource type="Script" uid="uid://bsv40w867i0ye" path="res://code/player.gd" id="1_o5qli"]
[ext_resource type="Script" uid="uid://bpsvkjcb822ad" path="res://code/dust_bar.gd" id="2_jyhfs"]
[ext_resource type="PackedScene" uid="uid://bdjrsigh8ajkn" path="res://scenes/dirt_world_3d.tscn" id="3_sugp2"]
[ext_resource type="Script" uid="uid://bxotqlnrj5vex" path="res://code/dust_label.gd" id="3_tbgi4"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_7dm0k"]
sky_top_color = Color(0.344926, 0.309394, 1, 1)
sky_horizon_color = Color(9.62615e-07, 0.720907, 0.914811, 1)
ground_bottom_color = Color(0.0915683, 4.81307e-07, 0.539424, 1)
ground_horizon_color = Color(0, 0.77729, 0.483354, 1)

[sub_resource type="Sky" id="Sky_ig7tw"]
sky_material = SubResource("ProceduralSkyMaterial_7dm0k")

[sub_resource type="Environment" id="Environment_0xm2m"]
background_mode = 2
sky = SubResource("Sky_ig7tw")
ambient_light_source = 3

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_sgp6g"]

[sub_resource type="BoxShape3D" id="BoxShape3D_sgp6g"]
size = Vector3(40, 1, 30)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_h2yge"]
albedo_color = Color(0.233925, 0.233925, 0.233925, 1)

[sub_resource type="PlaneMesh" id="PlaneMesh_1bvp3"]
material = SubResource("StandardMaterial3D_h2yge")
size = Vector2(40, 30)

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_sugp2"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_sgp6g"]
height = 0.1
radius = 0.35

[sub_resource type="CylinderMesh" id="CylinderMesh_sgp6g"]
top_radius = 0.35
bottom_radius = 0.35
height = 0.1

[sub_resource type="Gradient" id="Gradient_sugp2"]
offsets = PackedFloat32Array(0.010274, 1)
colors = PackedColorArray(0.0980392, 0.0980392, 0.0980392, 1, 0.17, 0.10217, 0.0629, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_jyhfs"]
gradient = SubResource("Gradient_sugp2")

[sub_resource type="BoxShape3D" id="BoxShape3D_sugp2"]
resource_local_to_scene = true
size = Vector3(20, 5, 20)

[node name="Main" type="Node3D"]

[node name="Room" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Room"]
environment = SubResource("Environment_0xm2m")

[node name="Sun" type="DirectionalLight3D" parent="Room"]
transform = Transform3D(0.91739, 0.368891, -0.149382, -0.000957724, 0.377387, 0.926055, 0.397988, -0.849411, 0.346564, 0, 3.89882, 0)
light_color = Color(0.337255, 0.533333, 1, 1)
shadow_enabled = true
directional_shadow_split_1 = 0.06
directional_shadow_max_distance = 10.0

[node name="Floor" type="StaticBody3D" parent="Room"]
physics_material_override = SubResource("PhysicsMaterial_sgp6g")

[node name="BoxCollider" type="CollisionShape3D" parent="Room/Floor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, 0)
shape = SubResource("BoxShape3D_sgp6g")

[node name="Mesh" type="MeshInstance3D" parent="Room/Floor"]
mesh = SubResource("PlaneMesh_1bvp3")
skeleton = NodePath("../../..")

[node name="Couch" parent="Room" instance=ExtResource("1_0wfyh")]
transform = Transform3D(0.413788, 0, 0.910373, 0, 1, 0, -0.910373, 0, 0.413788, -2.65407, 0.361659, 0)

[node name="Couch2" parent="Room" instance=ExtResource("1_0wfyh")]
transform = Transform3D(0.976383, 0, -0.216048, 0, 1, 0, 0.216048, 0, 0.976383, 1.9925, 0.361659, 3.26853)

[node name="Couch3" parent="Room" instance=ExtResource("1_0wfyh")]
transform = Transform3D(0.794849, 0, 0.606807, 0, 1, 0, -0.606807, 0, 0.794849, 2.15593, 0.361659, -2.72817)

[node name="Couch4" parent="Room" instance=ExtResource("1_0wfyh")]
transform = Transform3D(-0.712785, 0, 0.701382, 0, 1, 0, -0.701382, 0, -0.712785, -2.20311, 0.361659, -3.66627)

[node name="Couch5" parent="Room" instance=ExtResource("1_0wfyh")]
transform = Transform3D(-0.712785, 0, 0.701382, 0, 1, 0, -0.701382, 0, -0.712785, 3.6031, 0.361659, 0.168037)

[node name="CanvasLayer" type="CanvasLayer" parent="Room"]

[node name="WholeWindow" type="PanelContainer" parent="Room/CanvasLayer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_styles/panel = SubResource("StyleBoxEmpty_sugp2")

[node name="PanelContainer" type="PanelContainer" parent="Room/CanvasLayer/WholeWindow"]
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 8

[node name="ProgressBar" type="ProgressBar" parent="Room/CanvasLayer/WholeWindow/PanelContainer"]
custom_minimum_size = Vector2(400, 20)
layout_mode = 2
show_percentage = false
script = ExtResource("2_jyhfs")

[node name="Label" type="Label" parent="Room/CanvasLayer/WholeWindow/PanelContainer/ProgressBar"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
text = "0 / ?"
horizontal_alignment = 1
vertical_alignment = 1
script = ExtResource("3_tbgi4")

[node name="Player" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0676021, 0)
script = ExtResource("1_o5qli")

[node name="CylinderCollider" type="CollisionShape3D" parent="Player"]
shape = SubResource("CylinderShape3D_sgp6g")

[node name="Mesh" type="MeshInstance3D" parent="Player"]
mesh = SubResource("CylinderMesh_sgp6g")
skeleton = NodePath("")

[node name="Main Camera" type="Camera3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 0.991216, 0.132256, 0, -0.132256, 0.991216, 0, 0.420815, 0.978399)

[node name="OmniLight3D" type="OmniLight3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0255488, 0)
light_color = Color(0, 0.509804, 1, 1)
light_energy = 0.515
shadow_enabled = true

[node name="DirtWorld3D" parent="." node_paths=PackedStringArray("player") instance=ExtResource("3_sugp2")]
max_particles = 20000
player = NodePath("../Player")
color_range = SubResource("GradientTexture1D_jyhfs")

[node name="BoundsShape" parent="DirtWorld3D/Bounds" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.5, 0)
shape = SubResource("BoxShape3D_sugp2")

[node name="Particles" parent="DirtWorld3D" index="1"]
cast_shadow = 0

[connection signal="on_dust_collected" from="DirtWorld3D" to="Room/CanvasLayer/WholeWindow/PanelContainer/ProgressBar" method="_on_dirt_world_3d_on_dust_collected"]
[connection signal="on_dust_collected" from="DirtWorld3D" to="Room/CanvasLayer/WholeWindow/PanelContainer/ProgressBar/Label" method="_on_dirt_world_3d_on_dust_collected"]
[connection signal="on_dust_initialized" from="DirtWorld3D" to="Room/CanvasLayer/WholeWindow/PanelContainer/ProgressBar" method="_on_dirt_world_3d_on_dust_initialized"]
[connection signal="on_dust_initialized" from="DirtWorld3D" to="Room/CanvasLayer/WholeWindow/PanelContainer/ProgressBar/Label" method="_on_dirt_world_3d_on_dust_initialized"]

[editable path="DirtWorld3D"]
